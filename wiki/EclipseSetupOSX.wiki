#summary Setting up Eclipse for developing IPT on Mac OS X
<font color=red>
_Warning: This page relates to the deprecated version 1 of the IPT_
</font>
= Developing IPT on Mac OS X =

The following describes a typical Eclipse development setup for working with IPT source code in the following environment:
 * OS X 10.5.8
 * Java 1.6.0_15 
 * Eclipse Galileo 64 bit
 * Subclipse 1.6 (Eclipse Plugin)
 * Web Tools Platform 3.1 (Eclipse Plugin)
 * M2Eclipse (Eclipse Plugin with embedded Maven)
 * FreeMarker (Eclipse Plugin)

=== Check out source code ===
Using Subclipse, *check out as a project in the workspace* the main line of IPT development and name the project *ipt*:

{{{
https://gbif-providertoolkit.googlecode.com/svn/trunk/gbif-providertool
}}}

=== Enable Maven dependency management ===
IPT uses *Maven* for building and managing the project, which is configured using the *pom.xml* file located in the root directory of the *ipt* project. 

To activate Maven, make sure you have the *M2_REPOS* classpath variable defined in Eclipse:

{{{
Eclipse->Preferences->Java->Build Path->Classpath Variables->New...
# Create a variable named "M2_REPOS" pointing to your local Maven repository (i.e. ~/.m2/repository).
}}}

Also, configure *Maven preferences* in Eclipse:

{{{
Eclipse->Preferences->Maven...
# Set *Goals to run on project import* to `org.apache.maven.plugins:maven-eclipse-plugin:2.6:eclipse` 
# Select the checkbox next to *Download repository index updates on startup* 
# Select the checkbox next to *Update Maven projects on startup*.
}}}


Next, check out the *motherpom* project:

{{{
https://gbif-providertoolkit.googlecode.com/svn/trunk/motherpom
}}}

and then right-click the project and *Run As->Maven Install*. Finally, use the *M2Eclipse* plugin to *enable dependency management* for the *ipt* project. The Maven menu is available by right-clicking the *ipt* project.

At this point, if there is an error in the project ("Some errors were encountered while processing the poms."), restart Eclipse and it will automatically update the dependencies. This should remove the error.

=== Create a run configuration ===
To run the IPT web app, create a new Maven Build run configuration.

Right-click the *ipt* project and *Run As->Run configurations->Maven Build*. Press the "New" button to create a configuration. Name it *ipt-eclipse*. 

In the *Main* tab of the *ipt-eclipse* run configuration, type *eclipse* in the *Profiles* box. Select the *Update Snapshots* and *Skip Tests* checkboxes. For the *Maven Runtime* option, click the *Configure...* button, add the *External* Maven installation on your machine, click *Okay*, and then select it as the *Maven Runtime* in the *ipt-eclipse* Maven Build.

In the *JRE* tab of the *ipt-eclipse* run configuration, type the following *VM arguments*:

{{{
-Xmx1048m -Xdebug -Xnoagent -Djava.compiler=NONE -Xrunjdwp:transport=dt_socket,address=4000,server=y,suspend=n
}}}

After clicking *Run*, the *ipt* project will compile and deploy the web app to `http://localhost:8080`. Note that the VM arguments include flags for debugging at address 4000. This allows us to create a run configuration for debugging the IPT web app.

=== Create a run configuration for debugging ===
To debug the IPT web app with breakpoints, create a debug configuration

Right-click the *ipt* project and *Debug As->Debug configurations->Remote Java Application*. Press the "New" button to create a configuration. Name it *ipt-remote-debug*.

In the *Connect* tab of the *ipt-remote-debug* run configuration, under *Connection Properties* set the *Port* to *4000*. 

Now the application is ready for debugging. Simply set some breakpoints in the server side Java source files or client side JSP files and click *Debug*. 

Finally, accessing the IPT web app at` http://localhost:8080` will bring you into debug mode at your breakpoints.