#summary Introduction to Darwin Core
<wiki:toc max_depth="3" />

= Introduction =
Darwin Core is an upcoming standard from [http://www.tdwg.org/activities/darwincore/ TDWG], currently under review, which is based on the ideas 
of the popular [http://dublincore.org/documents/dcmi-terms/ terms from the Dublin Core Metadata Initiative].
A strong principle is to not tie the definition of a term to a technology, e.g. XML or RDF.

== IPT and Darwin Core ==
The IPT has core biodiversity data types built-in, which are based on Darwin Core (DwC) terms. 
These core types, i.e. occurrence and checklist records, are not changeable and have a fixed set of terms describing them.

== Darwin Core History ==
Traditionally Darwin Core has only been used to describe primary data, i.e. occurrences of species, in particular through DiGIR and XML encoding. 
When we were looking for a very simple checklist data exchange formats and with the rise of tagging of species on Flickr, it became apparent that simple terms for biodiversity in the tradition of Dublin Core would be very useful - and indeed very much overlapping with the 
Darwin Core terms in use already.

== Status ==
Currently DwC is under public review and is expected to be ratified before the next TDWG meeting in the beginning of November 2009.
As DwC has been a moving target during the development of the IPT, the consistent April 2009 DwC edition
was frozen and has been implemented in the current RC2 release of IPT 1.0. 

Small changes have been made to Darwin Core since, mainly renaming terms while keeping the definition the same. 
With the final ratification as a full TDWG standard the IPT will be updated to reflect these and released as the official version 1.0 GA.



= Terms =
All Darwin Core terms are defined in [http://rs.tdwg.org/dwc/terms/index.htm Darwin Core Terms: a quick reference guide]. 
Remember the current IPT still uses the [http://darwincore.googlecode.com/svn/tags/dwc-2009-04-IPT/terms/index.htm April edition].

A single DwC term, in IPT often called a property, can be used once for each record.
Generally it is free text, but the definition often recommends certain formats or vocabularies to use,
e.g. the ISO 2 letter country codes for `dwc:countryCode`.

== Patterns ==
=== ID terms ===
DwC provides a number of terms to assign identifiers to a record. 
These can be used to define an identifier (e.g. `occurrenceID`) but also to refer to an identifier defined somewhere else. 
For example `higherTaxonID` is used to refer to the `taxonID` of the parent taxon of the classification while `taxonID` itself is used to define a taxon in a checklist.
On the other hand `taxonID` used within an occurrence dataset generally points to a taxon defined somewhere else, such as a checklist datasets.

Most ID terms have a corresponding full text term, e.g. `acceptedTaxonID` and `acceptedTaxon`.
These serve two purposes: 

 # In the absence of an identifier they can be used to refer to another record, in this case the accepted/valid taxon.
 # They provide a human readable context that persists even if the identifier cannot be resolved

It therefore makes sense to provide both if possible.

=== Denormalised Hierarchies ===
The geography and taxonomy can be expressed as a flexible hierarchy of places or taxa through the terms `higherTaxon(ID)` and `higherGeography(ID)`.
In addition to this _adjencency list_ , the most popular ranks can be published as a denormalised hierarchy for each record, effectively repeating
this information across many records. But it does provide a quick, short and human readble classification for each record in isolation of the entire dataset.

 * Taxonomic denormalised classification: `kingdom`, `phylum`, `class`, `order`, `family`, `genus`, `subgenus`
 * Geographic denormalised classification:  `continent`, `waterBody`, `islandGroup`, `island`, `country` / `countryCode`, `stateProvince`, `county`

As with full text ID terms above this introduces the possibility of _data integrity problems_, as the ID term might resolve into something different
than the denormalised hierarchy. In this case the IPT follows the recommendation of the following precedence of terms for resolving the hierarchy:

{{{
 ID term >> Text term >> Denormalised term
 higherTaxonID >> higherTaxon >> kingdom,family,...
}}}

=== Verbatim terms ===
Quite a few terms have a corresponding verbatim term. This is to cater the publication of the exact verbatim transcription of certain attributes 
as they were found in the underlying specimen label, observation fieldbook or literature. This way the `verbatimEventDate` can be used to publish the
exact transcription of the collecting date, while `eventDate` can be encoded in a standard ISO date time representation.


== Primary data ==
All DwC terms can be used to describe an occurrence record.
It is recommended to publish at least the following terms. 
Terms flagged with !!! have to be present to be recognised by the current GBIF indexing:

 * [http://rs.tdwg.org/dwc/terms/index.htm#basisOfRecord basisOfRecord] !!!
 * [http://rs.tdwg.org/dwc/terms/index.htm#occurrenceID occurrenceID]
 * [http://rs.tdwg.org/dwc/terms/index.htm#institutionCode institutionCode] !!!
 * [http://rs.tdwg.org/dwc/terms/index.htm#collectionCode collectionCode] !!!
 * [http://rs.tdwg.org/dwc/terms/index.htm#catalogNumber catalogNumber] !!!
 * [http://rs.tdwg.org/dwc/terms/index.htm#recordedBy recordedBy]
 * [http://rs.tdwg.org/dwc/terms/index.htm#eventDate eventDate]
 * [http://rs.tdwg.org/dwc/terms/index.htm#year year]
 * [http://rs.tdwg.org/dwc/terms/index.htm#typeStatus typeStatus]
 * [http://rs.tdwg.org/dwc/terms/index.htm#scientificName  scientificName] !!!
 * [http://rs.tdwg.org/dwc/terms/index.htm#kingdom kingdom]
 * [http://rs.tdwg.org/dwc/terms/index.htm#family family]
 * [http://rs.tdwg.org/dwc/terms/index.htm#locality locality]
 * [http://rs.tdwg.org/dwc/terms/index.htm#decimalLongitude decimalLongitude]
 * [http://rs.tdwg.org/dwc/terms/index.htm#decimalLatitude decimalLatitude]
 * [http://rs.tdwg.org/dwc/terms/index.htm#coordinateUncertaintyInMeters coordinateUncertaintyInMeters]

=== Example ===
{{{
occurrenceID=96db9d09-596d-409c-8626-f4460078d0eb
institutionCode=BGBM
collectionCode=B
basisOfRecord=preservedspecimen
catalogNumber=1159
eventDate=1999-08-06 00:00:00.0
collector=Markus Döring
continent=Asia
country=TR
stateProvince=Adana
locality=Aladaglari, lower Narpiz Deresi, next to fountain, 2900m
minimumElevationInMeters=2900
decimalLatitude=37.82800
decimalLongitude=35.13600
geodeticDatum=WGS84
identifiedBy=Markus Döring
scientificName=Festuca anatolica subsp. anatolica
kingdom=Plantae
phylum=Magnoliophyta
class=
order=Cyperales
family=Poaceae
genus=Festuca
specificEpithet=anatolica
infraspecificEpithet=anatolica
}}}


== Checklists ==
Checklists are confined to +/- the taxonomic subset of all Darwin Core terms.

GBIF ECAT provides [http://code.google.com/p/gbif-ecat/wiki/publishingChecklists recommendations on how to publish species checklists].

=== Example ===
[http://spreadsheets.google.com/pub?key=tnoVriNunOOMzYp709vtauQ&output=html  Euro+Med dataset sample]

more examples can be found on the [http://code.google.com/p/gbif-ecat/wiki/publishingClassifications ECAT site]


= The Darwin Core Archive =
Darwin Core archives (DwC-A) are the new, primary means of publishing data to the GBIF network.
They contain an _entire dataset_, are based on _simple text files_ and can be created fairly easily without the IPT with _custom software_.

== Darwin Core Extensions ==
Recognising that DwC only covers the core biodiversity metadata, extensions to darwin core are a common need across all communities.
The simplest way to do so is to create new terms in a new namespace and simply extend a regular dwc record with these terms.

Often multiple _subrecords_ for an extension is desired, such as many common names for a species or multiple images for a specimen.
In order to share these richer, related records the *star scheme* is used, whereby an extension consists of multiple records, each linked to a core dwc record. Any number of extension records potentially from different extensions (e.g. images & identification) for a single core record is possible.


== The Archive Format ==
The Darwin Core archive format provides a means to publish dwc records plus extensions in a relatively simple, text-based format. 
A Darwin Core archive consists of a set of text files that are bundled into a common package and then zipped into a single archive file. 
The format follows the [http://rs.tdwg.org/dwc/terms/guides/text/index.htm Darwin Core text guidelines]. 
A typical package is illustrated in the diagram below and consists of components described in [http://code.google.com/p/gbif-ecat/wiki/DwCArchive details here].

http://gbif-ecat.googlecode.com/files/dwca.png

== Checklist Extensions ==
GBIF and the Global Names Architecture (GNA) are authoring several [http://spreadsheets.google.com/pub?key=r4I1G8E7mDIgY_kt9Rxyc8A GNA extensions for Darwin Core] to share species data. 
Theses are still drafts, but very stable already and expected to be released shortly after Darwin Core has been ratified.



= Best Practices =
 
 # prefer to use standard CSV (i.e. delimiter = , quotation = ") or TAB files instead of custom delimiters and quotes
 # always encode text as UTF-8
 # make sure you have replaced line breaks, i.e. \r \n or \r\n with either simple spaces or use 2 characters "\r" to escape the line break if the intention is to preserve them
 # encode NULLs as empty fields, i.e. no characters between 2 delimiters, not \N or \NULL
 # DwC-A requires a identifier column. In case only a single core file is needed, this column may contain NULLs, i.e. empty fields. It is still required to designate a column for identifiers. This is to be avoided as much as possible and it is highly recommended to supply records with IDs.
 # dwc:higherTaxon(ID), dwc:acceptedTaxon(ID) or dwc:basionym(ID) must point to existing records in the dataset. Specifically it is invalid to point to higher taxa which dont exist as records. For this the denormalised higher darwin core ranks like dwc:kingdom should be used.
 # always include dwc:kingdom. If its the same throughout the dataset consider using a static mapping in the meta descriptor, see below
 # if you can, include dwc:phylum and dwc:family
 # test your archive with the [http://code.google.com/p/gbif-indexingtoolkit/wiki/DarwinCoreArchiveReader dwc-a reader]
 # the primary key in the core taxon file, mapped to the Darwin Core taxonID term, is preferred to be a globally unique identifier (GUID) rather than a typical integer id that is not unique outside the source database.
 