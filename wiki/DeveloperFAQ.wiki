#summary Developer Frequently Asked Questions

<wiki:toc max_depth="2" />

= Configuration files =
 * web.xml
 * struts.xml (configures all actions and URL mappings)
 * hibernate.cfg.xml
 * urlrewrite.xml (RESTFUL to url parameter rewriting)
 * applicationContext.xml (Spring beans) 
   # applicationContext-dao.xml
   # applicationContext-i18n-maps.xml
   # applicationContext-resources.xml
   # applicationContext-service.xml 
   # applicationContext-struts.xml
   # applicationContext.xml

== Properties Files ==
 * application.properties (IPT app settings) 
 * ipt.properties (user configurable domain, base URL, data directory, mail settings)
 * velocity.properties (static)
 * displaytag.properties (static)
 * xwork-conversion.properties (static)

= Html templates/rendering =
== Page layout ==
 * src/main/webapp/WEB-INF/decorators.xml
 * src/main/webapp/WEB-INF/sitemesh.xml

= Architecture =
IPT uses a simple 2-Tier architecture with DAO and services merged into a single service layer. With the exception of AppFuse user management is 3-tier DAO and services - which should be migrated to 2tiers when moving into ipt packages.

= Points of Interest in code =

== IPT data directory layout ==
See AppConfig in particular. The web context property resolver is used to find the absolute webapp dir at runtime regardless of which app server and JVM location.
{{{
WebContextPropertyResolver.java
AppConfig.java
}}}

== Upload Process ==

http://www.websequencediagrams.com/cgi-bin/cdraw?lz=U291cmNlLT5JbXBvcnRBY3Rpb246IHVwbG9hZAoACQwtPkNhY2hlTWFuYWdlcjogcnVuVQAgBm5vdGUgcmlnaHQgb2YgABgOQXN5bmNocm9ub3VzIGNvdXBsaW5nIHVzaW5nIEpESyBGdXR1cmU8AEQGRXZlbnQ-CgBcDACBEQhUYXNrOiBjYWxsKCkAgRAHVGFzawARDmluaXQoKQCBAQ8ANAxyZXNldACBAwVudHMsIAAIBWZsYWdzIChlLmcuIGRlcml2ZWRUYXhvbm9teT8AXQ4AgXIOcHJlcGFyZQCBfgYAbghvdmVyAIFzD2ZsYWdBc0RlbGV0ZWRcbnJlbW92ZUQAYwZEYXRhIChFLmcuIHQAbgZpYyAvIGdlb2dyYXBoaWNhbCBoaWVyYXJjaGllcykANwhTdGF0cwBECEV4dGVuc2lvbkRhdGEAWQhBcmNoaXZlcwCCHw0AgX8NaQCDbAVDb3JlAIIWHWRldGVybWluZSBpZiBtb2RpZmllZFxudXBkYXRlIC8gaW5zZXJ0c1xuY3JlYXRlIGFubm90YXRpb25zIGZvciBiYWQgcm93cwpsb29wIEZvciBlYWNoIGUAgS0IIHR5cGUKIACDHAsAg0UPAIUTBQCBWwkoKQogIACCYQoAVVVlbmQAhGgcbG9zZQCEdg8AhFUQb2x2ZSBpZHMgcmVmZXJlbmNlZCBieSBuYW1lIGZpZWxkcyAoYmFzaW9ueW1zLCBoaWdoZXIgdGF4YSBldGMAQRsAglcHZSBhbWJpZ3VvdXMAUAUAg0wbYnVpbGQgbmVzdGVkAIVrBigAYwUAhFsLZXMAgTMbAINiB3N0YXQARSFEd0MtQQCEWBpnZW5lcmF0ZSBMdWNlbmUgaW5kZXgK&s=modern-blue&foo.png

[http://www.websequencediagrams.com/?lz=U291cmNlLT5JbXBvcnRBY3Rpb246IHVwbG9hZAoACQwtPkNhY2hlTWFuYWdlcjogcnVuVQAgBm5vdGUgcmlnaHQgb2YgABgOQXN5bmNocm9ub3VzIGNvdXBsaW5nIHVzaW5nIEpESyBGdXR1cmU8AEQGRXZlbnQ-CgBcDACBEQhUYXNrOiBjYWxsKCkAgRAHVGFzawARDmluaXQoKQCBAQ8ANAxyZXNldACBAwVudHMsIAAIBWZsYWdzIChlLmcuIGRlcml2ZWRUYXhvbm9teT8AXQ4AgXIOcHJlcGFyZQCBfgYAbghvdmVyAIFzD2ZsYWdBc0RlbGV0ZWRcbnJlbW92ZUQAYwZEYXRhIChFLmcuIHQAbgZpYyAvIGdlb2dyYXBoaWNhbCBoaWVyYXJjaGllcykANwhTdGF0cwBECEV4dGVuc2lvbkRhdGEAWQhBcmNoaXZlcwCCHw0AgX8NaQCDbAVDb3JlAIIWHWRldGVybWluZSBpZiBtb2RpZmllZFxudXBkYXRlIC8gaW5zZXJ0c1xuY3JlYXRlIGFubm90YXRpb25zIGZvciBiYWQgcm93cwpsb29wIEZvciBlYWNoIGUAgS0IIHR5cGUKIACDHAsAg0UPAIUTBQCBWwkoKQogIACCYQoAVVVlbmQAhGgcbG9zZQCEdg8AhFUQb2x2ZSBpZHMgcmVmZXJlbmNlZCBieSBuYW1lIGZpZWxkcyAoYmFzaW9ueW1zLCBoaWdoZXIgdGF4YSBldGMAQRsAglcHZSBhbWJpZ3VvdXMAUAUAg0wbYnVpbGQgbmVzdGVkAIVrBigAYwUAhFsLZXMAgTMbAINiB3N0YXQARSFEd0MtQQCEWBpnZW5lcmF0ZSBMdWNlbmUgaW5kZXg&s=modern-blue Edit]

== Internationalization ==
Internationalisation is done on templates (.ftl, .jsp) and action classes using java resource bundles in src/main/resources/ApplicationResources.properties. Resource bundles finally have to be encoded as latin1 and other unicode characters need to be escaped. This is ok for western languages with few special unicode characters, but especially for asian languages this is unwieldy. We therefore encode the proeprty files in UTF8 and use the native2ascii maven plugin to process the files into valid property files.

 * [http://struts.apache.org/2.x/docs/text.html Struts2 i18n]
 * http://java.sun.com/j2se/1.5.0/docs/tooldocs/windows/native2ascii.html
 * http://mojo.codehaus.org/native2ascii-maven-plugin/native2ascii-mojo.html

A nice tool to help translation is Attesoro. It will mean we have to work with valid property files from the beginning though, removing the native2ascii plugin and utf8 bundles:
 * http://attesoro.org/screenshot.html

To add new internationalization follow these steps:
  * Download Attesoro from http://attesoro.org/download.html
  * Download the default properties file ApplicationResources.properties from the gbif-providertoolkit project site (http://gbif-providertoolkit.googlecode.com/svn/trunk/gbif-providertool/src/main/resources/ApplicationResources.properties).
  * In the same location as the default properties in the previous step, download the properties file from the gbif-providertoolkt project site for the language to which you wish to translate. For example, for the French properties file, download http://gbif-providertoolkit.googlecode.com/svn/trunk/gbif-providertool/src/main/resources/ApplicationResources-fr.properties.
  * Open the Attesoro jar file (e.g., attesoro_1_8.jar). It is an executable jar file that will run as an application if you have Java installed on your system. Otherwise you will have to install Java and then run the Attesoro jar file.
  * In Attesoro, select the File->Open menu item and open the ApplicationResources.properties file downloaded from the gbif-providertoolkit project site in a previous step, above. If you have done all of the previous steps correctly you should see a screen such as the following:

http://gbif-providertoolkit.googlecode.com/files/Attesoro-fr.png


 
== Registry and Publication Process ==

== Lucene ==
Main index is across all metadata through all resources. There is also one for each resource that indexes each data.